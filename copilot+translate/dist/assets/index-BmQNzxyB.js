var u=(e=>(e.Local="local",e.Sync="sync",e.Managed="managed",e.Session="session",e))(u||{}),E=(e=>(e.ExtensionPagesOnly="TRUSTED_CONTEXTS",e.ExtensionPagesAndContentScripts="TRUSTED_AND_UNTRUSTED_CONTEXTS",e))(E||{});const r=globalThis.chrome;async function g(e,i){function t(a){return typeof a=="function"}function n(a){return a instanceof Promise}return t(e)?(n(e),e(i)):e}let C=!1;function f(e){if(r&&r.storage[e]===void 0)throw new Error(`Check your storage permission in manifest.json: ${e} is not defined`)}function y(e,i,t){var S,T;let n=null,a=!1,l=[];const o=(t==null?void 0:t.storageEnum)??u.Local,L=(t==null?void 0:t.liveUpdate)??!1,P=((S=t==null?void 0:t.serialization)==null?void 0:S.serialize)??(s=>s),w=((T=t==null?void 0:t.serialization)==null?void 0:T.deserialize)??(s=>s);C===!1&&o===u.Session&&(t==null?void 0:t.sessionAccessForContentScripts)===!0&&(f(o),r==null||r.storage[o].setAccessLevel({accessLevel:E.ExtensionPagesAndContentScripts}).catch(s=>{console.warn(s),console.warn("Please call setAccessLevel into different context, like a background script.")}),C=!0);const d=async()=>{f(o);const s=await(r==null?void 0:r.storage[o].get([e]));return s?w(s[e])??i:i},p=()=>{l.forEach(s=>s())},m=async s=>{a===!1&&(n=await d()),n=await g(s,n),await(r==null?void 0:r.storage[o].set({[e]:P(n)})),p()},U=s=>(l=[...l,s],()=>{l=l.filter(c=>c!==s)}),_=()=>n;d().then(s=>{n=s,a=!0,p()});async function z(s){if(s[e]===void 0)return;const c=w(s[e].newValue);n!==c&&(n=await g(c,n),p())}return L&&(r==null||r.storage[o].onChanged.addListener(z)),{get:d,set:m,getSnapshot:_,subscribe:U}}const h=new Map;function b(e){return h.has(e)||h.set(e,A(e.get())),h.get(e).read()}function A(e){let i="pending",t;const n=e.then(a=>{i="success",t=a},a=>{i="error",t=a});return{read(){switch(i){case"pending":throw n;case"error":throw t;default:return t}}}}const v=y("theme-storage-key","light",{storageEnum:u.Local,liveUpdate:!0}),x={...v,toggle:async()=>{await v.set(e=>e==="light"?"dark":"light")}},D=y("user-storage-key",{id:"",name:"",email:"",access_token:"",role:"user",department:"",fab:""},{storageEnum:u.Local,liveUpdate:!0});export{x as T,D as U,b as u};
