import{N as u,n as i,L as x,i as o,a as s,b as m,u as f,c as g}from"./navigation.store-D970gqwf.js";import"./index-lOtXKBCI.js";async function c(){const e=await i.get();return x(`Navigation: ${e}`),e===u.SidepanelChat}async function l(e,n){if(await chrome.sidePanel.open({windowId:e}),await c()){n();return}const t=setInterval(async()=>{await c()&&(clearInterval(t),n())},100)}function h(){chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error(e)),chrome.runtime.onConnect.addListener(function(e){e.name===u.Sidepanel&&e.onDisconnect.addListener(async()=>{i.clear()})})}const r=[{id:"icloud-copilot-contextmenu-ask",title:o("ask_extensionName",o("extensionName")),contexts:["all"],onclick:(e,n)=>{l((n==null?void 0:n.windowId)??1,()=>{s({type:"clipboard",value:o("ask_extensionName",e.selectionText??"")},t=>console.log(t))})}},{id:"icloud-copilot-contextmenu-translate",title:o("translate_extensionName",o("extensionName")),contexts:["all"],onclick:(e,n)=>{l((n==null?void 0:n.windowId)??1,()=>{s({type:"clipboard",value:o("translate_content",e.selectionText??"")},t=>console.log(t))})}},{id:"icloud-copilot-contextmenu-upload-image",title:o("uploadImageToICloud"),contexts:["image"]}];function v(){chrome.runtime.onInstalled.addListener(()=>{r.map(e=>({id:e.id,title:e.title,contexts:e.contexts})).forEach(e=>{chrome.contextMenus.create(e)})}),chrome.contextMenus.onClicked.addListener((e,n)=>{var a;const t=r.find(p=>p.id===e.menuItemId);t&&((a=t.onclick)==null||a.call(t,e,n))})}i.clear();m(o("loaded_app",o("serviceWorker")));v();h();let d=!1;chrome.runtime.onConnect.addListener(()=>{d||(d=!0,f.load().then(e=>{m(o("hasUser_bool",g(e)?"false":"true"))}))});
