import{n as s,L as u,a as d,i as t,b as c,c as m,u as p,d as h}from"./navigation.store-BNlAX0pi.js";import"./index-jTOKpEbi.js";function r(e,n){chrome.sidePanel.open({windowId:e}).then(async()=>{const o=async()=>{const a=await s.get();return d(`Navigation: ${a}`),a==="sidepanel/chat"};if(await o()){n();return}const i=s.subscribe(async()=>{await o()&&(n(),i())})}).catch(o=>u(o))}function g(){chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error(e))}const l=[{id:"icloud-copilot-contextmenu-ask",title:t("ask_extensionName",t("extensionName")),contexts:["all"],onclick:(e,n)=>{r((n==null?void 0:n.windowId)??1,()=>{c({type:"clipboard",value:e.selectionText},o=>console.log(o))})}},{id:"icloud-copilot-contextmenu-translate",title:t("translate_extensionName",t("extensionName")),contexts:["all"],onclick:(e,n)=>{r((n==null?void 0:n.windowId)??1,()=>{c({type:"clipboard",value:t("translate_content",e.selectionText??"")},o=>console.log(o))})}},{id:"icloud-copilot-contextmenu-upload-image",title:t("uploadImageToICloud"),contexts:["image"]}];function f(){chrome.runtime.onInstalled.addListener(()=>{l.map(e=>({id:e.id,title:e.title,contexts:e.contexts})).forEach(e=>{chrome.contextMenus.create(e)})}),chrome.contextMenus.onClicked.addListener((e,n)=>{l.forEach(o=>{var i;e.menuItemId===o.id&&((i=o==null?void 0:o.onclick)==null||i.call(o,e,n))})})}m(t("loaded_app",t("serviceWorker")));f();g();chrome.runtime.onConnect.addListener(e=>{d(`Connected to ${e.name}`),p.load().then(n=>{m(t("hasUser_bool",h(n)?"false":"true"))})});
